# Прогнозирование временных рядов с использованием ARIMA и LSTM

## Описание проекта
Этот проект посвящен анализу и прогнозированию временных рядов, используя вероятностные методы (ARIMA) и методы машинного обучения (LSTM). Комбинация этих подходов позволяет объединить сильные стороны статистических и нейросетевых моделей, создавая более точные и надежные предсказания.

## Структура проекта
Проект состоит из следующих этапов:

### 1. Подготовка данных
Временной ряд делится на обучающую и тестовую выборки, что позволяет модели учиться на одной части данных и проверять свои предсказания на другой. Данные нормализуются для улучшения работы нейронной сети LSTM.

### 2. Модель ARIMA
ARIMA (AutoRegressive Integrated Moving Average) — это статистическая модель, которая хорошо подходит для анализа временных рядов с трендами и сезонностью. В данном проекте модель ARIMA используется для предсказания временных рядов, поскольку она способна учитывать структуру данных и делать вероятностные прогнозы.

### 3. Модель LSTM
LSTM (Long Short-Term Memory) — это тип рекуррентной нейронной сети (RNN), который хорошо подходит для обработки временных рядов с длительными зависимостями. LSTM эффективно моделирует сложные временные паттерны, поэтому модель позволяет предсказывать временные ряды на основе нелинейных зависимостей.

### 4. Ансамблевый прогноз
Для улучшения точности предсказаний создается ансамблевый прогноз, который объединяет результаты моделей ARIMA и LSTM. Усреднение предсказаний двух моделей помогает сгладить ошибки каждой из них и делает итоговый прогноз более устойчивым к шуму и аномалиям.

### 5. Визуализация результатов
Результаты прогнозов ARIMA, LSTM и ансамблевой модели визуализируются на графике, что позволяет наглядно сравнить предсказания каждой модели с реальными данными. Ансамблевый прогноз представлен отдельной линией, которая показывает объединенное предсказание.

## Выводы
Комбинирование статистических и нейросетевых методов позволяет создать гибридную модель, способную лучше справляться с прогнозированием временных рядов, содержащих как линейные, так и нелинейные паттерны. Ансамблевый подход помогает достичь более точных предсказаний, что полезно для прогнозирования спроса на продукцию, цен акций и других временных данных.

## Использованные библиотеки
- **statsmodels** — для работы с моделью ARIMA.
- **tensorflow** — для создания и обучения LSTM модели.
- **matplotlib** — для визуализации прогнозов и анализа результатов.

## Как запустить проект
1. Скачайте и установите зависимости, указанные в `requirements.txt`.
2. Запустите файл `forecasting.py`, чтобы выполнить все этапы анализа и прогнозирования временного ряда.
3. Результаты предсказаний будут отображены на графике.

## Обновления кода:

- SARIMA: Добавлена модель SARIMA, которая лучше справляется с сезонными данными, что расширяет ансамбль и добавляет статистическую модель с сезонной компонентой.
- GRU: Добавлена модель GRU, которая работает аналогично LSTM и часто эффективнее на данных временных рядов, добавляя гибкость нейросетевой части ансамбля.
- Настройка гиперпараметров: Параметры для ARIMA и SARIMA подобраны для более точного предсказания.
- Взвешенное усреднение: Вместо простого усреднения используется взвешенное, позволяя более значимым моделям (например, SARIMA) оказывать большее влияние на итоговый прогноз.
