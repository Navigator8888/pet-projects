# Байесовская модель для прогнозирования фондового рынка

Данный проект демонстрирует применение методов байесовского машинного обучения для прогнозирования временных рядов на примере фондового рынка. Здесь мы разрабатываем модель, которая оценивает вероятность различных исходов и позволяет учесть неопределенность, типичную для реальных рыночных данных. В частности, используются LSTM (долгая краткосрочная память) и вариационный автоэнкодер (VAE) для прогнозирования будущих цен и интервалов доверия.

## Основные особенности

- **Прогнозирование временных рядов с LSTM**: Модель LSTM предсказывает цены на основе скользящего окна исторических данных. LSTM подходит для захвата временных зависимостей в данных фондового рынка.
- **Вариационный автоэнкодер (VAE)**: Для учета неопределенности применен VAE. Эта модель генерирует распределение вероятных будущих значений цен и позволяет вычислить интервал неопределенности для прогноза.
- **Оценка неопределенности**: С помощью VAE модель прогнозирует диапазоны цен с 95%-ным доверительным интервалом, что помогает оценить риски при высокой волатильности.

## Установка

Для запуска кода необходимо установить следующие библиотеки:

pip install tensorflow numpy matplotlib

##  Описание кода

1. Подготовка данных
   
Генерируется временной ряд, представляющий исторические данные фондового рынка. В реальном проекте эти данные могут быть заменены на данные с биржи, например, с использованием API Yahoo Finance или других источников.

2. Модель LSTM
   
LSTM обучается на окнах временных рядов фиксированной длины. Модель предсказывает следующее значение цены и помогает уловить паттерны, основанные на прошлых данных.

3. Вариационный автоэнкодер (VAE)
   
VAE служит для генерации распределения возможных будущих цен и расчета доверительного интервала. Энкодер сжимает временные данные в латентное пространство, а декодер восстанавливает прогнозы на основе распределения вероятности.

4. Прогнозирование и визуализация
Модель строит прогноз на несколько временных шагов вперед и вычисляет доверительный интервал для полученного прогноза. На графике показаны:

- Исторические данные
- Прогноз LSTM
- Среднее значение прогноза VAE с 95%-м доверительным интервалом

## Результаты
Модель показывает вероятные колебания цен на рынке, предоставляя диапазон предсказаний с учетом неопределенности. Такой подход позволяет получать не только прогноз, но и оценку риска, что полезно для анализа и принятия инвестиционных решений.
