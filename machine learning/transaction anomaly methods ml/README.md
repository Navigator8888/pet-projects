# Обнаружение аномалий в транзакциях с использованием методов машинного обучения

## Описание проекта
В данном проекте реализована задача **обнаружения аномалий** в банковских транзакциях с целью выявления потенциального мошенничества. Мы используем методы машинного обучения — **One-Class SVM**, **Isolation Forest** и **PCA** — для анализа данных и поиска отклонений от нормального поведения, которые могут свидетельствовать о подозрительных действиях.

## Основные методы
1. **One-Class SVM**:
   - Этот метод обучается только на нормальных данных и выявляет аномалии как отклонения.
   - В процессе кросс-валидации (`GridSearchCV`) подбираются оптимальные параметры, такие как `nu`, `kernel` и `gamma`, для повышения точности модели.

2. **Isolation Forest**:
   - Изолирующий лес изолирует данные с помощью случайных деревьев, что позволяет эффективно выявлять аномалии.
   - Для настройки модели также используется `GridSearchCV`, чтобы выбрать наилучшие параметры (`n_estimators`, `contamination`, `max_samples`).

3. **PCA (Метод главных компонент)**:
   - Метод PCA уменьшает размерность данных и восстанавливает их, чтобы рассчитать ошибку восстановления. Высокая ошибка восстановления может свидетельствовать о наличии аномалии.
   - Для выявления аномалий используется пороговое значение ошибки восстановления, основанное на 95-м перцентиле.

## Основные шаги реализации

### 1. Генерация данных
Генерируются нормальные и аномальные транзакции:
- Нормальные транзакции генерируются из многомерного нормального распределения.
- Аномальные транзакции имеют отличающееся распределение, чтобы симулировать мошенничество.

### 2. Масштабирование данных
Данные масштабируются с использованием `StandardScaler` для улучшения работы моделей.

### 3. Кросс-валидация и настройка параметров
Для `One-Class SVM` и `Isolation Forest` проводится подбор гиперпараметров с использованием кросс-валидации. Это позволяет найти оптимальные параметры для повышения точности моделей.

### 4. Обнаружение аномалий
Каждая модель используется для классификации данных и выявления аномалий:
- **One-Class SVM** и **Isolation Forest** возвращают метки `-1` для аномальных данных, которые преобразуются в `1`.
- **PCA** использует ошибку восстановления для классификации: если ошибка превышает определенный порог, транзакция считается аномальной.

### 5. Визуализация результатов
Построены графики для визуализации исходных данных и результатов обнаружения аномалий каждой моделью. Используются `matplotlib` и `seaborn` для представления нормальных и аномальных транзакций разными цветами.

## Заключение

В проекте рассмотрены методы машинного обучения для обнаружения аномалий в данных. Благодаря кросс-валидации и настройке параметров достигнуты оптимальные результаты, а визуализация помогает в интерпретации моделей.


Методы показывают различную точность в обнаружении аномалий:

- One-Class SVM и Isolation Forest хорошо справляются с задачей при настройке параметров.
- PCA менее точен, но подходит для использования в качестве вспомогательного метода анализа.
